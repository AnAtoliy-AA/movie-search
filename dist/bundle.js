!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var a=class{constructor({Title:e,Year:t,imdbID:s,Type:a,Poster:r}){this.title=e,this.year=t,this.imdbID=s,this.type=a,this.poster=r,this.imdbRating=null}createDOMCard(){const e=document.createElement("div"),t=`https://www.imdb.com/title/${this.imdbID}/`,s=document.createElement("div"),a=document.createElement("div"),r=document.createElement("a"),n=document.createElement("p"),i=document.createElement("p");return i.innerHTML="&#9733;  "+this.imdbRating,r.innerText=this.title,r.href=t,a.classList.add("card-title"),n.innerText="Year: "+this.year,s.classList.add("card-image"),e.classList.add("swiper-slide"),this.getCardImgUrl(s),a.appendChild(r),e.appendChild(a),e.appendChild(s),e.appendChild(n),e.appendChild(i),e}updateDetails(e){e&&(this.imdbRating=e.imdbRating)}getCardImgUrl(e){const t=`url(${this.poster})`,s="url(./assets/no-img-available.png)";e.style.backgroundImage="url(N/A)"===t?s:`${t}, ${s}`}};var r=function(){return function(){const e=document.getElementById("main-container"),t=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div");t.classList.add("swiper-container"),s.classList.add("swiper-wrapper"),a.classList.add("swiper-pagination"),r.classList.add("swiper-button-prev"),n.classList.add("swiper-button-next"),i.classList.add("swiper-scrollbar"),t.appendChild(s),t.appendChild(a),t.appendChild(r),t.appendChild(n),t.appendChild(i),e.appendChild(t)}(),new Swiper(".swiper-container",{direction:"horizontal",initialSlide:1,preloadImages:!0,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},scrollbar:{el:".swiper-scrollbar"},slidesPerView:4,spaceBetween:0,breakpoints:{250:{slidesPerView:1,spaceBetween:0},480:{slidesPerView:2,spaceBetween:0},780:{slidesPerView:3,spaceBetween:0},1079:{slidesPerView:4,spaceBetween:0}}})};const n="1abc55ac",i="trnsl.1.1.20200508T093226Z.509bbc3c7b82dcc9.e20b1eaa78b0260dcd915efcf0b967ccb668ccfd",o="warrior",d="1";var c=class{constructor(){this.searchWord=o,this.activePageNumber=d,this.filmCards=[],this.domFilmCards=[],function(){const e=document.createElement("div"),t=document.createElement("div");e.classList.add("main-container","wrapper"),e.style.backgroundImage="url(./assets/main-container-img.png)",e.id="main-container",t.id="message-container",e.appendChild(t),document.body.appendChild(e)}(),this.getDomCardContainer(),r(),this.getDomSwiper(),this.toggleLoaderSpinner(),this.searchFilms(),this.searchForm=this.getSearchForm(),this.messageContainer=this.getMessageContainer(),this.addSubmitListner(),this.getNextDomFilms()}searchFilms(){this.getFilmTitleData(this.searchWord,this.activePageNumber)}createDomFilmCards(){return this.filmCards.map(e=>e.createDOMCard())}getDomSwiper(){this.domSwiper=document.querySelector(".swiper-container").swiper}async getFilmTitleData(e,t){const s=`http://www.omdbapi.com/?s=${e}&page=${t}&apikey=${n}`,a=await fetch(s),r=await a.json();this.analyzeApiResponse(r)}analyzeApiResponse(e){const t=this.getSearchText();e.Search?(this.createFilmCards(e.Search),this.updateFilmsDetailsData(e)):(this.toggleLoaderSpinner(),this.messageContainer.innerText="No results for "+t)}async updateFilmsDetailsData(e){const t=e.Search.map(e=>this.getfilmDetailsData(e.imdbID));Promise.all(t).then(e=>{e.forEach(e=>this.updateFilmCardDetails(e)),this.updateDomFilmCards()}),this.toggleLoaderSpinner()}updateDomFilmCards(){this.domFilmCards=this.createDomFilmCards(),this.appendListOfDomCardsToSwiper(this.domFilmCards)}createFilmCards(e){this.filmCards=e.map(e=>new a(e))}appendListOfDomCardsToSwiper(e){Array.isArray(e)&&e.forEach(e=>{this.domSwiper.appendSlide(e)})}async getfilmDetailsData(e){const t=`http://www.omdbapi.com/?i=${e}&page=1&apikey=${n}`;return(await fetch(t)).json()}updateFilmCardDetails(e){const t=this.filmCards.find(t=>t.imdbID===e.imdbID);t&&t.updateDetails(e)}getDomCardContainer(){this.domCardContainer=document.getElementById("main-container")}getSearchForm(){return document.getElementById("search-form")}addSubmitListner(){this.searchForm.addEventListener("submit",e=>{e.preventDefault(),this.submitTextFromSearchForm()})}submitTextFromSearchForm(){const e=this.getSearchText();this.messageContainer.innerText="",this.activePageNumber=d,e.length>0?(this.toggleLoaderSpinner(),this.chooseLanguageOfSearchText(e)):this.messageContainer.innerText="Please, enter some word"}getSearchText(){return document.getElementById("search-text").value.toString()}chooseLanguageOfSearchText(e){const t=new RegExp("[а-я]","i");this.clearSwiperContainer(),t.test(e)?this.getTextForRusWords(e):(this.searchWord=e,this.searchFilms())}async getTextForRusWords(e){const t=`https://translate.yandex.net/api/v1.5/tr.json/translate?key=${i}&text=${e}&lang=ru-en`,s=await fetch(t),a=await s.json();this.messageContainer.innerText="Showing results for "+a.text,this.searchWord=a.text,this.searchFilms()}getMessageContainer(){return document.getElementById("message-container")}getLoaderSpinner(){return document.getElementById("spiner")}toggleLoaderSpinner(){this.getLoaderSpinner().classList.toggle("hidden")}clearSwiperContainer(){this.domSwiper.removeAllSlides()}getNextDomFilms(){this.domSwiper.on("reachEnd",()=>{this.domSwiper.activeIndex>0&&(this.activePageNumber++,this.toggleLoaderSpinner(),this.getFilmTitleData(this.searchWord,this.activePageNumber))})}};var l=class{constructor(){this.createHeader()}createHeader(){const e=document.createElement("header"),t=this.createHeaderNavBar();e.appendChild(t),document.body.appendChild(e)}createHeaderNavBar(){const e=document.createElement("nav"),t=document.createElement("a"),s=document.createElement("h1");return e.classList.add("wrapper","navbar","navbar-expand-lg","navbar-dark","bg-dark"),t.classList.add("navbar-brand"),t.href="#",s.innerText="Movie search",t.appendChild(s),e.appendChild(t),e}};var h=class{constructor(){this.createFooter()}createFooter(){const e=document.createElement("footer"),t=this.createFooterText(),s=this.createFooterImage();e.classList.add("footer","wrapper","bg-dark"),e.appendChild(t),e.appendChild(s),document.body.appendChild(e)}createFooterText(){const e=document.createElement("div");return e.classList.add("footer-text"),e.innerText="RS School 2020q1",e}createFooterImage(){const e=document.createElement("a"),t=document.createElement("img");return e.href="https://github.com/",e.classList.add("footer-image"),t.src="./assets/git-logo.png",t.alt="GitHub",e.appendChild(t),e}};var m=class{constructor(e,t,s,a,r,n,i,o,d,c,l){this.value=e,this.valueLabel=t,this.rusValue=s,this.rusValueLabel=a,this.keyCode=r,this.row=n,this.position=i,this.width=o,this.alternativeValue=d,this.rusAlternativeValue=c,this.location=l,this.id=l?`${r}_${l}`:""+r}};var p=function(){return[new m("`","~","ё","ё",192,1,1,40,"~"),new m("1","1","1","1",49,1,2,40,"!","!"),new m("2","2","2","2",50,1,3,40,"@","@"),new m("3","3","3","3",51,1,4,40,"#","#"),new m("4","4","4","4",52,1,5,40,"$","$"),new m("5","5","5","5",53,1,6,40,"%","%"),new m("6","6","6","6",54,1,7,40,"^","^"),new m("7","7","7","7",55,1,8,40,"&","&"),new m("8","8","8","8",56,1,9,40,"*","*"),new m("9","9","9","9",57,1,10,40,"(","("),new m("0","0","0","0",48,1,11,40,")",")"),new m("-","-","-","-",189,1,12,40,"_","_"),new m("=","=","=","=",187,1,13,40,"+","+"),new m("backspace","Backspace","backspace","Backspace",8,1,14,110),new m("tab","Tab","tab","Tab",9,2,1,60),new m("q","q","й","й",81,2,2,40),new m("w","w","ц","ц",87,2,3,40),new m("e","e","у","у",69,2,4,40),new m("r","r","к","к",82,2,5,40),new m("t","t","е","е",84,2,6,40),new m("y","y","н","н",89,2,7,40),new m("u","u","г","г",85,2,8,40),new m("i","i","ш","ш",73,2,9,40),new m("o","o","щ","щ",79,2,10,40),new m("p","p","з","з",80,2,11,40),new m("[","[","х","х",219,2,12,40),new m("]","]","ъ","ъ",221,2,13,40),new m("\\","\\","\\","\\",220,2,14,40,"|","/"),new m("del","DEL","del","DEL",46,2,15,40),new m("capsLock","Caps Lock","capsLock","Caps Lock",20,3,1,90),new m("a","a","ф","ф",65,3,2,40),new m("s","s","ы","ы",83,3,3,40),new m("d","d","в","в",68,3,4,40),new m("f","f","а","а",70,3,5,40),new m("g","g","п","п",71,3,6,40),new m("h","h","р","р",72,3,7,40),new m("j","j","о","о",74,3,8,40),new m("k","k","л","л",75,3,9,40),new m("l","l","д","д",76,3,10,40),new m(";",";","ж","ж",186,3,11,40),new m("'","'","э","э",222,3,12,40),new m("enter","Enter","enter","Enter",13,3,13,105),new m("","Shift","","Shift",16,4,1,110,null,null,1),new m("z","z","я","я",90,4,2,40),new m("x","x","ч","ч",88,4,3,40),new m("c","c","с","с",67,4,4,40),new m("v","v","м","м",86,4,5,40),new m("b","b","и","и",66,4,6,40),new m("n","n","т","т",78,4,7,40),new m("m","m","ь","ь",77,4,8,40),new m(",",",","б","б",188,4,9,40,"<"),new m(".",".","ю","ю",190,4,10,40,">"),new m("/","/",".",".",191,4,11,40,"?",","),new m("","&uarr;","","&uarr;",38,4,12,40),new m("","Shift","","Shift",16,4,13,85,null,null,2),new m("","Ctrl","","Ctrl",17,5,1,40,null,null,1),new m("lang","RUS","lang","ENG",91,5,2,40),new m("","Alt","","Alt",18,5,3,40,null,null,1),new m("space","Space","space","Space",32,5,4,345),new m("","Alt","","Alt",18,5,5,40,null,null,2),new m("leftArrow","&larr;","leftArrow","&larr;",37,5,7,40),new m("","&darr;","","&darr;",40,5,8,40),new m("rightArrow","&rarr;","rightArrow","&rarr;",39,5,9,40),new m("","Ctrl","","Ctrl",17,5,6,40,null,null,2)]};const u="16_1",g="16_2",w="20",b="18_1",y="18_2",v="capsLock",S="lang",f="backspace",C="del",L="space",E="tab",k="enter",T="leftArrow",x="rightArrow",A=["112","113","114","115","116","117","118","119","120","121","122","123"];function P(e){return 0!==e.location?`${e.keyCode}_${e.location}`:""+e.keyCode}var K=class{constructor(){this.englishLanguage="true"===sessionStorage.lastSelectedLanguage,this.cssClassNameConfig={keyboardKeyActive:"keyboard__key_active"},this.vKeys=p(),this.domScreen=document.getElementById("search-text"),this.domKeyboard=this.createDomKeyboard(),this.domKeys=document.querySelectorAll(".keyboard__key"),this.addActiveKeyboardKey(),this.bindPhysicalKeyboardEvents(),this.capsLockEnabled=!1,this.shiftPressed=!1,this.keepPressedButtonsArray=[],this.toggleVirtualKeyboard()}createDomKeyboard(){const{body:e}=document,t=document.createElement("div"),s=p();e.appendChild(t),t.classList.add("virtual-keyboard","wrapper","hidden");for(let e=1;e<6;e++){const s=document.createElement("div");s.id="row_"+e,s.classList.add("keyboard__row"),t.appendChild(s)}for(let e=0;e<s.length;e++){const t=s[e],a=document.createElement("div");a.innerHTML=this.englishLanguage?t.valueLabel:t.rusValueLabel,a.style.width=t.width+"px",a.classList.add("keyboard__key"),a.id=t.id,document.getElementById("row_"+t.row).appendChild(a)}return t}addActiveKeyboardKey(){this.domKeys.forEach(e=>{e.addEventListener("mousedown",e=>{e.target.id!==w&&e.target.classList.add(this.cssClassNameConfig.keyboardKeyActive),this.pressKey(e)}),e.addEventListener("mouseup",()=>{this.domKeys.forEach(e=>this.removeClassKeyActive(e)),this.domScreen.focus()})})}removeClassKeyActive(e){e.classList.remove(this.cssClassNameConfig.keyboardKeyActive)}bindPhysicalKeyboardEvents(){const e=[...this.domKeys];document.addEventListener("keydown",t=>{if(!A.some(e=>e===P(t))){const s=e.find(e=>e.id===P(t));s&&(s.id!==w&&s.classList.add(this.cssClassNameConfig.keyboardKeyActive),this.addKeepPressedButtonsArray(s.id),this.pressKey(t)),t.preventDefault()}}),document.addEventListener("keyup",t=>{const s=e.find(e=>e.id===P(t));s&&(e.forEach(e=>this.removeClassKeyActive(e)),this.removeKeepPressedButtonsArray(s.id)),""+t.keyCode===u&&this.disableShift(),this.analysePressedKeys()})}addKeepPressedButtonsArray(e){-1===this.keepPressedButtonsArray.indexOf(e)&&this.keepPressedButtonsArray.push(e)}removeKeepPressedButtonsArray(e){const t=this.keepPressedButtonsArray.indexOf(e);this.keepPressedButtonsArray.splice(t,1)}toggleCapsLock(){this.capsLockEnabled=!this.capsLockEnabled,document.getElementById(w).classList.toggle("keyboard__caps-lock_active")}prepareSymbolToShowInScreen(e){let t="";return t=this.englishLanguage?this.capsLockEnabled?this.shiftPressed?e.alternativeValue||e.value.toLowerCase():e.value.toUpperCase():this.shiftPressed?e.alternativeValue||e.value.toUpperCase():e.value.toLowerCase():this.capsLockEnabled?this.shiftPressed?e.alternativeValue||e.rusValue.toLowerCase():e.rusValue.toUpperCase():this.shiftPressed?e.rusAlternativeValue||e.rusValue.toUpperCase():e.rusValue.toLowerCase(),t}analysePressedKeys(){2===this.keepPressedButtonsArray.filter(e=>e===b||e===y||e===u||e===g).length&&this.toggleEnglishLanguage(),1===this.keepPressedButtonsArray.filter(e=>e===u||e===g).length&&this.enableShift(),0===this.keepPressedButtonsArray.filter(e=>e===u||e===g).length&&this.disableShift(),this.setVirtualKeyboardKeyCase()}enableShift(){this.shiftPressed=!0}disableShift(){this.shiftPressed=!1}setVirtualKeyboardKeyCase(){[...this.domKeys].filter(e=>e.innerHTML&&1===e.innerHTML.length).forEach(e=>{const t=e;this.shiftPressed&&this.capsLockEnabled||!this.shiftPressed&&!this.capsLockEnabled?t.innerHTML=t.innerHTML.toLowerCase():t.innerHTML=t.innerHTML.toUpperCase()})}toggleEnglishLanguage(){this.englishLanguage=!this.englishLanguage,sessionStorage.setItem("lastSelectedLanguage",this.englishLanguage),this.domKeys.forEach(e=>{const t=e,s=this.vKeys.find(e=>e.id===t.id),a=s.valueLabel,r=s.rusValueLabel;t.innerHTML=this.englishLanguage?a:r})}pressKey(e){this.analysePressedKeys();const t=this.vKeys.find(t=>t.id===e.target.id||t.id===P(e));switch(t.value){case v:this.toggleCapsLock();break;case S:this.toggleEnglishLanguage();break;case f:this.vScreen.removeLastSymbol();break;case C:this.vScreen.removeRightSymbol();break;case L:this.vScreen.addSpaceToScreen();break;case E:this.vScreen.addTabToScreen();break;case T:this.vScreen.leftArrowMove();break;case x:this.vScreen.rightArrowMove();break;case k:this.vContainer.clearSwiperContainer(),this.vContainer.submitTextFromSearchForm();break;default:this.vScreen.addSymbolToScreen(this.prepareSymbolToShowInScreen(t))}}toggleVirtualKeyboard(){document.querySelector(".keyboard-image").addEventListener("click",()=>{this.domKeyboard.classList.toggle("hidden")})}setScreen(e){this.vScreen=e}setContainer(e){this.vContainer=e}};var D=class{constructor(){!function(){const e=document.createElement("form"),t=document.createElement("div"),s=document.createElement("input"),a=document.createElement("div"),r=document.createElement("div"),n=document.createElement("button");e.id="search-form",e.classList.add("wrapper","form-inline","my-2","my-lg-0"),t.classList.add("input"),s.id="search-text",s.classList.add("form-control-lg","mr-sm-2"),s.type="search",s.autocomplete="off",s.autofocus="on",s.placeholder="Search movie",a.id="spiner",a.classList.add("loader","hidden"),r.style.backgroundImage="url(./assets/keyboard.png)",r.classList.add("keyboard-image"),n.type="submit",n.classList.add("btn","btn-secondary","my-2","my-sm-0"),n.innerText="Search",t.appendChild(s),t.appendChild(a),t.appendChild(r),e.appendChild(t),e.appendChild(n),document.body.appendChild(e)}(),this.domScreen=document.getElementById("search-text")}addSymbolToScreen(e){this.domScreen.setRangeText(e),this.rightArrowMove()}removeLastSymbol(){this.domScreen.selectionEnd-=1,this.domScreen.selectionEnd+=1,this.domScreen.setRangeText("")}removeRightSymbol(){this.domScreen.selectionEnd+=1,this.domScreen.setRangeText("")}addSpaceToScreen(){this.domScreen.setRangeText(" "),this.rightArrowMove()}addEnterToScreen(){this.domScreen.setRangeText("\n"),this.rightArrowMove()}rightArrowMove(){this.domScreen.selectionEnd+=1,this.domScreen.selectionStart=this.domScreen.selectionEnd}leftArrowMove(){this.domScreen.selectionEnd-=1,this.domScreen.selectionStart=this.domScreen.selectionEnd}addTabToScreen(){this.domScreen.setRangeText("\t"),this.rightArrowMove()}};new l;const F=new D,B=new c,I=new K;new h;I.setScreen(F),I.setContainer(B)}]);